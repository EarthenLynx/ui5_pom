sap.ui.define(["sap/ui/model/json/JSONModel"],function(t){"use strict";const s={pomodoro:{name:"Working",msTotal:15e5},shortBreak:{name:"Short Break",msTotal:3e5},longBreak:{name:"Long break",msTotal:9e5},minFocus:{msTotal:6e5},appearance:{theme:"dark"},notification:{desktopNotification:false,soundUrl:"/assets/boxing_gong.mp3"},history:{session:true,persistent:false}};const e=t.extend("sap.ui.demo.basicTemplate.model.PomodoroModel",{modelname:"Pomodoro",tie(t){t.getOwnerComponent().setModel(this,this.modelname)},init(){const{msTotal:t}=this.getProperty("/settings/pomodoro");this.setTimer(t)},setStatusNext(){const{isWorking:t,isPausingShort:s,isPausingLong:e}=this.getProperty("/status");const{history:i}=this.getData();if((i.length+2)%8===0){return this.setStatusPausingLong()}if(t){return this.setStatusPausingShort()}if(s||e){return this.setStatusWorking()}},setStatusPrevious(){const{isWorking:t,isPausingShort:s,isPausingLong:e}=this.getProperty("/status");if(e){return this.setStatusPausingLong()}if(s){return this.setStatusPausingShort()}if(t){return this.setStatusWorking()}},setTimer(t){this.setProperty("/timer/msTotal",t);this.setProperty("/timer/msLeft",t);this.setProperty("/timer/msExpired",0)},setStatusWorking(){const{msTotal:t,name:s}=this.getProperty("/settings/pomodoro");this.setProperty("/status",{isWorking:true,isPausingShort:false,isPausingLong:false});this.setProperty("/statusName",s);this.setTimer(t)},setStatusPausingShort(){const{msTotal:t,name:s}=this.getProperty("/settings/shortBreak");this.setProperty("/status",{isWorking:false,isPausingShort:true,isPausingLong:false});this.setProperty("/statusName",s);this.setTimer(t)},setStatusPausingLong(){const{msTotal:t,name:s}=this.getProperty("/settings/longBreak");this.setProperty("/status",{isWorking:false,isPausingShort:true,isPausingLong:false});this.setProperty("/statusName",s);this.setTimer(t)},startTicking(t){this.stopTicking(true);const s=setInterval(()=>{this.tick(t)},1e3);this.setProperty("/intervalHandler",s);this.setProperty("/timer/ticking",true)},stopTicking(t=false){const s=this.getProperty("/intervalHandler");if(t===true){for(let t=1;t<Math.max();t++){clearInterval(t)}}clearInterval(s);this.setProperty("/timer/ticking",false)},tick(t){const{statusName:s}=this.getData();let{msLeft:e,msExpired:i}=this.getProperty("/timer");e-=1e3;i+=1e3;document.title=`${s} - ${(e/6e4).toFixed(1)} Minutes left`;if(e===0){this.playPhaseDoneAudio();setTimeout(()=>{document.title=`Finished ${s}`;t.handleFinishCurrentPhase()},1e3)}this.setProperty("/timer/msLeft",e);this.setProperty("/timer/msExpired",i)},addToHistory(t){if(this.getProperty("/settings/history/session")===true){const s=this.getProperty("/history");const e=s.findIndex(s=>s.title==t.title&&s.status.isWorking===t.status.isWorking&&s.status.isPausingShort===t.status.isPausingShort&&s.status.isPausingLong===t.status.isPausingLong);if(e>=0){s[e].msExpired+=t.msExpired}else{s.push(t)}this.setProperty("/history",s);if(this.getProperty("/settings/history/persistent")===true){if(!localStorage.getItem("history")){localStorage.setItem("history",JSON.stringify([]))}const s=JSON.parse(localStorage.getItem("history"));s.push(t);localStorage.setItem("history",JSON.stringify(s))}}},clearHistory(t=false){this.setProperty("/history",[]);if(t===true){localStorage.setItem("history",JSON.stringify([]))}},syncHistory(){const t=localStorage.getItem("history");if(!!t&&t!=="[]"){this.setProperty("/history",JSON.parse(t));return true}else{return false}},saveUserSettings(){const{settings:t}=this.getData();localStorage.setItem("pomodoro-user-settings",JSON.stringify(t))},syncUserSettings(){const t=localStorage.getItem("pomodoro-user-settings");if(!!t){this.setProperty("/settings",JSON.parse(t));return true}else{return false}},resetUserSettings(){this.setProperty("/settings",{...s})},playPhaseDoneAudio(){const{soundUrl:t}=this.getProperty("/settings/notification");const s=new Audio(t);s.play()}});return new e({timer:{msTotal:0,msLeft:0,msExpired:0,ticking:false},statusName:"Working",status:{isWorking:true,isPausingShort:false,isPausingLong:false},settings:{...s},task:{title:"Nothing in particular",desc:""},taskEstimation:0,history:[],intervalHandler:null})});