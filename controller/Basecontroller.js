sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/Text","sap/m/Dialog","sap/m/Button","sap/m/MessageStrip","../model/Pomodoro.model","../model/Task.model"],function(e,t,o,s,a,i,n,r){"use strict";return e.extend("sap.ui.demo.basicTemplate.controller.Basecontroller",{async requestNotificationPermission(){const e=Notification.permission;if(e!=="granted"){const e=await Notification.requestPermission();if(e==="granted"){t.show("You will now receive notifications whenever a phase is over");return true}else{t.show("You will receive no notifications. You can change your decision in the Settings panel");return false}}},async sendNotification(e,t){const o=await Notification.requestPermission();if(o==="granted"){const o=new Notification(e,t);o.onclick=e=>{e.preventDefault();window.focus();o.close()}}},_handleCreateMessageStrip(e,t,o){const s=this.getView().byId(o);const a=new i({text:e,type:t,showCloseButton:true,showIcon:true});s.addContent(a)},_handleCreateConfirmationPopup(e,t){var i=new s({title:"Information",type:"Message",state:"Information",content:new o({text:e}),beginButton:new a({text:"Cancel",type:"Reject",press(){i.close();return}}),endButton:new a({text:"Confirm",type:"Accept",press(){if(t){t()}i.close()}}),afterClose(){i.destroy()}});i.open();return},handleSetUserTheme(){if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches){this._setTheme("dark")}if(localStorage.getItem("user-theme")){const e=localStorage.getItem("user-theme");this._setTheme(e)}},handleToggleUserTheme(){const e=localStorage.getItem("user-theme");if(e==="dark"){this._setTheme("light")}else{this._setTheme("dark")}},handleDeleteHistory(e=false){if(e===true){t.show("All historical data has been removed from your computer")}if(e===false){t.show("Session data cleared")}this.handleCloseHistoryDialog();r.clearHistory(e)},handleExportHistory(){const{history:e}=r.getData();const t=Object.keys(e[0]);const o=(e,t)=>t===null?"":t;let s=e.map(e=>t.map(t=>JSON.stringify(e[t],o)).join(";"));s.unshift(t.join(";"));s=s.join("\r\n");const a=new Blob([s]);const i=document.createElement("a");i.href=URL.createObjectURL(a);i.download="filename.csv";document.body.appendChild(i);i.click();document.body.removeChild(i)},_setTheme(e){if(e==="dark"){n.setProperty("/settings/appearance/theme","dark");localStorage.setItem("user-theme","dark");sap.ui.getCore().applyTheme("sap_fiori_3_dark")}else if(e==="light"){n.setProperty("/settings/appearance/theme","light");localStorage.setItem("user-theme","light");sap.ui.getCore().applyTheme("sap_fiori_3")}}})});